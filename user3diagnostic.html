<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MediLink | Diagnostic Tests</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-[#E6F3F7] font-['Inter'] text-gray-800">

<div class="flex min-h-screen">
  <!-- Sidebar -->
  <aside class="bg-white w-64 p-6 flex flex-col gap-4 border-r border-blue-100">
    <div class="flex items-center justify-center mb-6">
      <img src="img/logo3.png" alt="MediLink Logo" class="h-12 w-auto object-contain" />
    </div>
    <nav class="flex flex-col gap-2">
      <a href="user0dashboard.html" class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-blue-50 hover:text-blue-700 transition">Profile</a>
      <a href="user1record.html" class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-blue-50 hover:text-blue-700 transition">Health Records</a>
      <a href="user2appointment.html" class="flex items-center gap-2 px-4 py-2 rounded-md hover:bg-blue-50 hover:text-blue-700 transition">Appointments</a>
      <a href="user3diagnostic.html" class="flex items-center gap-2 px-4 py-2 rounded-md bg-blue-100 text-blue-700 font-semibold">Diagnostic Tests</a>
    </nav>
    <div class="mt-auto text-xs text-gray-400 text-center border-t border-blue-50 pt-4">
      Â© 2025 MediLink
    </div>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 px-10 pt-24 pb-8 relative">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-2xl font-bold text-blue-700">Diagnostic Tests</h2>
    </div>

<header class="absolute top-0 right-0 left-0 bg-white px-10 py-4 flex items-center justify-end border-b border-blue-100 shadow-sm">
  <div class="flex items-center gap-4">
    <div class="flex flex-col text-right">
      <span class="font-semibold text-gray-700">Raisa Tasnim</span>
      <span class="text-sm text-gray-500">User</span>
    </div>
    <div class="rounded-full bg-blue-200 flex items-center justify-center w-10 h-10 text-blue-700 text-lg font-bold">R</div>
    <button class="px-4 py-2 border border-blue-700 text-blue-700 rounded hover:bg-blue-50 transition">Logout</button>
  </div>
</header>

<!-- Search & Filter -->
<div class="flex flex-col md:flex-row md:items-center gap-4 mb-6">
  <input type="text" id="searchInput" placeholder="Search test name" class="flex-1 px-4 py-3 border border-blue-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300"/>
  <select id="filterSelect" class="px-4 py-3 border border-blue-100 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-300">
    <option value="all">All Test Types</option>
    <option value="Sample Test">Sample Test</option>
    <option value="Scan Test">Scan Test</option>
  </select>
</div>

<!-- Tests Grid -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="testsGrid">
  <!-- Sample Tests -->
  <div class="bg-white border border-blue-100 rounded-xl p-6 shadow flex justify-between items-center" data-type="Sample Test">
    <div>
      <p class="text-sm text-gray-500">Sample Test</p>
      <h3 class="text-lg font-semibold text-gray-800 mt-1">CBC</h3>
      <p class="text-sm text-gray-600 mt-1">Complete Blood Count</p>
    </div>
    <div class="flex flex-col items-end gap-2">
      <span class="text-blue-600 font-bold">Fee: 500 BDT</span>
      <button class="px-4 py-2 text-white bg-blue-700 rounded-lg hover:bg-blue-600 transition bookBtn">Book Now</button>
    </div>
  </div>

  <div class="bg-white border border-blue-100 rounded-xl p-6 shadow flex justify-between items-center" data-type="Sample Test">
    <div>
      <p class="text-sm text-gray-500">Sample Test</p>
      <h3 class="text-lg font-semibold text-gray-800 mt-1">Dengue Test</h3>
      <p class="text-sm text-gray-600 mt-1">Dengue Antigen/Antibody Test</p>
    </div>
    <div class="flex flex-col items-end gap-2">
      <span class="text-blue-600 font-bold">Fee: 600 BDT</span>
      <button class="px-4 py-2 text-white bg-blue-700 rounded-lg hover:bg-blue-600 transition bookBtn">Book Now</button>
    </div>
  </div>

  <div class="bg-white border border-blue-100 rounded-xl p-6 shadow flex justify-between items-center" data-type="Sample Test">
    <div>
      <p class="text-sm text-gray-500">Sample Test</p>
      <h3 class="text-lg font-semibold text-gray-800 mt-1">Typhoid Test</h3>
      <p class="text-sm text-gray-600 mt-1">Widal Test for Typhoid</p>
    </div>
    <div class="flex flex-col items-end gap-2">
      <span class="text-blue-600 font-bold">Fee: 400 BDT</span>
      <button class="px-4 py-2 text-white bg-blue-700 rounded-lg hover:bg-blue-600 transition bookBtn">Book Now</button>
    </div>
  </div>

  <div class="bg-white border border-blue-100 rounded-xl p-6 shadow flex justify-between items-center" data-type="Sample Test">
    <div>
      <p class="text-sm text-gray-500">Sample Test</p>
      <h3 class="text-lg font-semibold text-gray-800 mt-1">Blood Sugar</h3>
      <p class="text-sm text-gray-600 mt-1">Fasting & Random Blood Sugar</p>
    </div>
    <div class="flex flex-col items-end gap-2">
      <span class="text-blue-600 font-bold">Fee: 300 BDT</span>
      <button class="px-4 py-2 text-white bg-blue-700 rounded-lg hover:bg-blue-600 transition bookBtn">Book Now</button>
    </div>
  </div>

  <!-- Scan Tests -->
  <div class="bg-white border border-blue-100 rounded-xl p-6 shadow flex justify-between items-center" data-type="Scan Test">
    <div>
      <p class="text-sm text-gray-500">Scan Test</p>
      <h3 class="text-lg font-semibold text-gray-800 mt-1">X-Ray</h3>
      <p class="text-sm text-gray-600 mt-1">Chest/Bone X-Ray</p>
    </div>
    <div class="flex flex-col items-end gap-2">
      <span class="text-blue-600 font-bold">Fee: 1000 BDT</span>
      <button class="px-4 py-2 text-white bg-blue-700 rounded-lg hover:bg-blue-600 transition bookBtn">Book Now</button>
    </div>
  </div>

  <div class="bg-white border border-blue-100 rounded-xl p-6 shadow flex justify-between items-center" data-type="Scan Test">
    <div>
      <p class="text-sm text-gray-500">Scan Test</p>
      <h3 class="text-lg font-semibold text-gray-800 mt-1">MRI</h3>
      <p class="text-sm text-gray-600 mt-1">Brain/Spine MRI</p>
    </div>
    <div class="flex flex-col items-end gap-2">
      <span class="text-blue-600 font-bold">Fee: 5000 BDT</span>
      <button class="px-4 py-2 text-white bg-blue-700 rounded-lg hover:bg-blue-600 transition bookBtn">Book Now</button>
    </div>
  </div>

  <div class="bg-white border border-blue-100 rounded-xl p-6 shadow flex justify-between items-center" data-type="Scan Test">
    <div>
      <p class="text-sm text-gray-500">Scan Test</p>
      <h3 class="text-lg font-semibold text-gray-800 mt-1">CT Scan</h3>
      <p class="text-sm text-gray-600 mt-1">Head/Chest CT</p>
    </div>
    <div class="flex flex-col items-end gap-2">
      <span class="text-blue-600 font-bold">Fee: 4000 BDT</span>
      <button class="px-4 py-2 text-white bg-blue-700 rounded-lg hover:bg-blue-600 transition bookBtn">Book Now</button>
    </div>
  </div>

  <div class="bg-white border border-blue-100 rounded-xl p-6 shadow flex justify-between items-center" data-type="Scan Test">
    <div>
      <p class="text-sm text-gray-500">Scan Test</p>
      <h3 class="text-lg font-semibold text-gray-800 mt-1">Ultrasound</h3>
      <p class="text-sm text-gray-600 mt-1">Abdominal/Pelvic Ultrasound</p>
    </div>
    <div class="flex flex-col items-end gap-2">
      <span class="text-blue-600 font-bold">Fee: 1500 BDT</span>
      <button class="px-4 py-2 text-white bg-blue-700 rounded-lg hover:bg-blue-600 transition bookBtn">Book Now</button>
    </div>
  </div>
</div>

</main>
</div>

<!-- Booking Modal -->
<div id="bookingModal" class="fixed inset-0 hidden items-center justify-center bg-black/40 z-50">
  <div class="bg-white rounded-2xl w-full max-w-lg p-6 relative">
    <h3 class="text-lg font-semibold text-blue-700 mb-3">Book Diagnostic Test</h3>
    <form id="bookingForm" class="space-y-4">
      <input type="hidden" id="testNameHidden" name="testName" />
      <div>
        <label class="block text-xs text-gray-500 mb-1">Test Name</label>
        <input id="testDisplay" readonly class="w-full px-3 py-2 rounded-lg border border-blue-100 bg-blue-50 text-gray-700" />
      </div>
      <div>
        <label for="patientName" class="block text-xs text-gray-500 mb-1">Your Name</label>
        <input id="patientName" name="patientName" required class="w-full px-3 py-2 rounded-lg border border-blue-100 focus:ring-2 focus:ring-blue-200"/>
      </div>
      <div>
        <label for="patientContact" class="block text-xs text-gray-500 mb-1">Contact (phone/email)</label>
        <input id="patientContact" name="patientContact" required class="w-full px-3 py-2 rounded-lg border border-blue-100 focus:ring-2 focus:ring-blue-200"/>
      </div>
      <div>
        <label for="apptDate" class="block text-xs text-gray-500 mb-1">Preferred Date</label>
        <input type="date" id="apptDate" name="apptDate" required class="w-full px-3 py-2 rounded-lg border border-blue-100 focus:ring-2 focus:ring-blue-200"/>
      </div>
      <div>
        <label for="notes" class="block text-xs text-gray-500 mb-1">Notes (optional)</label>
        <textarea id="notes" name="notes" rows="3" class="w-full px-3 py-2 rounded-lg border border-blue-100"></textarea>
      </div>
      <div class="flex items-center justify-between">
        <div class="text-sm text-gray-600">Fee: <span id="feeDisplay" class="font-semibold text-blue-700"></span></div>
        <div class="flex gap-2">
          <button type="button" id="closeModal" class="px-4 py-2 rounded-lg border border-blue-200 text-gray-700 hover:bg-blue-50">Cancel</button>
          <button type="submit" class="px-4 py-2 rounded-lg bg-blue-700 text-white hover:bg-blue-600">Confirm</button>
        </div>
      </div>
      <div id="bookingError" class="text-sm text-red-600 hidden"></div>
    </form>
  </div>
</div>

<script>
const searchInput = document.getElementById("searchInput");
const filterSelect = document.getElementById("filterSelect");
const testsGrid = document.getElementById("testsGrid");

// Filter function
function filterTests() {
  const searchTerm = searchInput.value.toLowerCase();
  const filterTerm = filterSelect.value;

  const allCards = testsGrid.querySelectorAll('[data-type]');
  allCards.forEach(card => {
    const name = card.querySelector('h3').innerText.toLowerCase();
    const type = card.dataset.type;

    card.style.display = (name.includes(searchTerm) && (filterTerm === "all" || filterTerm === type)) ? "flex" : "none";
  });
}

searchInput.addEventListener("input", filterTests);
filterSelect.addEventListener("change", filterTests);

// Booking modal
const bookingModal = document.getElementById('bookingModal');
const testDisplay = document.getElementById('testDisplay');
const testNameHidden = document.getElementById('testNameHidden');
const feeDisplay = document.getElementById('feeDisplay');
const patientName = document.getElementById('patientName');
const patientContact = document.getElementById('patientContact');
const apptDate = document.getElementById('apptDate');
const notes = document.getElementById('notes');
const bookingForm = document.getElementById('bookingForm');
const bookingError = document.getElementById('bookingError');
const closeModalBtn = document.getElementById('closeModal');
const appointments = [];

// Attach modal open to all buttons
testsGrid.querySelectorAll('.bookBtn').forEach(btn => {
  btn.addEventListener('click', () => {
    const card = btn.closest('[data-type]');
    const testName = card.querySelector('h3').innerText;
    const fee = card.querySelector('span').innerText;

    testDisplay.value = testName;
    testNameHidden.value = testName;
    feeDisplay.textContent = fee;
    patientName.value = "";
    patientContact.value = "";
    notes.value = "";
    bookingError.classList.add('hidden');

    const today = new Date();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth()+1).padStart(2,'0');
    const dd = String(today.getDate()).padStart(2,'0');
    apptDate.min = `${yyyy}-${mm}-${dd}`;
    apptDate.value = `${yyyy}-${mm}-${dd}`;

    bookingModal.classList.remove('hidden');
    bookingModal.classList.add('flex');
  });
});

function closeBookingModal() {
  bookingModal.classList.remove('flex');
  bookingModal.classList.add('hidden');
}

closeModalBtn.addEventListener('click', closeBookingModal);
bookingModal.addEventListener('click', e => { if(e.target === bookingModal) closeBookingModal(); });

bookingForm.addEventListener('submit', e => {
  e.preventDefault();
  if(!patientName.value.trim() || !patientContact.value.trim() || !apptDate.value) {
    bookingError.textContent = "Please fill all required fields.";
    bookingError.classList.remove('hidden');
    return;
  }
  appointments.push({
    testName: testNameHidden.value,
    patientName: patientName.value,
    patientContact: patientContact.value,
    apptDate: apptDate.value,
    notes: notes.value,
    fee: feeDisplay.textContent
  });
  closeBookingModal();
  alert("Diagnostic test booked successfully!");
});
</script>
</body>
</html>
